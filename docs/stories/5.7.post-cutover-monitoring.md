# Story 5.7: Post-Cutover Monitoring

## Status

Draft

---

## Quick Project Assessment

**Current System Context**
- [x] Post-cutover success criteria require zero critical incidents for 7 days, error rate <1%, and performance within NFRs before migration closure (`docs/epics/epic-5-deployment.md:207-235`).
- [x] Monitoring dashboards, alarms, and alerting channels were stood up in Story 5.4 and are the primary observability surface once live traffic flows (`docs/epics/epic-5-deployment.md:297-322`, `docs/ops/runbook.md:5-153`).
- [x] Rollback readiness hinges on rapid EventBridge disablement and container redeploy workflows because no legacy Lambda fallback exists (`docs/epics/epic-5-deployment.md:286-336`).
- [x] Operations runbook prescribes daily, weekly, and incident response duties that govern the post-cutover watch rotation (`docs/ops/runbook.md:154-360`).
- [x] Go/No-Go Decision Point #3 closes the epic only after 1-week stability evidence and documentation hand-off are complete (`docs/epics/epic-5-deployment.md:352-390`).

**Change Scope**
- [ ] Maintain a 7-day monitoring log covering Lambda health, downstream integrations, and customer-impact indicators, storing artifacts under `docs/validation/story-5.7/` (`docs/epics/epic-5-deployment.md:207-235`).
- [ ] Validate CloudWatch dashboards, alarms, and Logs Insights queries remain accurate under production workload, correcting deviations and capturing proof in `VALIDATION.md` (`docs/epics/epic-5-deployment.md:297-322`, `docs/ops/runbook.md:5-210`, `docs/VALIDATION.md:1`).
- [ ] Drill rollback and escalation procedures to confirm the <35 minute detection-to-remediation SLA is achievable post-cutover (`docs/epics/epic-5-deployment.md:314-336`, `docs/ops/runbook.md:297-360`).
- [ ] Summarize daily findings, incidents, and approvals in `VALIDATION.md` and update risk/decision logs for the epic closure review (`docs/epics/epic-5-deployment.md:231-275`, `docs/epics/epic-5-deployment.md:352-390`, `docs/VALIDATION.md:1`).
- [ ] Archive legacy artifacts, finalize runbook updates, and prepare the migration completion package once stability criteria are met (`docs/epics/epic-5-deployment.md:231-235`, `docs/ops/runbook.md:360-404`).

---

## Story

**As an** on-call operations lead,  
**I want** to monitor the new Lambda and integrations for a full stabilization window after cutover,  
**so that** we prove production readiness, respond to anomalies within SLAs, and confidently close the migration.

---

## Story Context

- Post-cutover monitoring is the final proof point before declaring migration success, enforcing the 7-day zero-incident requirement and <1% error budget (`docs/epics/epic-5-deployment.md:207-235`).
- Monitoring and alerting infrastructure from Story 5.4 must operate flawlessly under live load, with dashboards and alarms aligned to the operations runbook playbooks (`docs/epics/epic-5-deployment.md:297-322`, `docs/ops/runbook.md:5-210`).
- Rollback procedure timelines (<35 minutes end-to-end) require regular drills because the legacy Lambda is unavailable as a safety net (`docs/epics/epic-5-deployment.md:286-336`).
- Decision Point #3 mandates documented stability evidence, stakeholder sign-off, and archived artifacts before Epic 5 can close (`docs/epics/epic-5-deployment.md:352-390`).
- VALIDATION.md, runbooks, and risk logs must be updated during the monitoring window to preserve audit trails and support downstream enhancements (`docs/VALIDATION.md:1`, `docs/ops/runbook.md:360-404`).

---

## Acceptance Criteria

**Functional Requirements**
1. Daily monitoring log captures Lambda invocation counts, error rates, execution durations (p50/p95), DynamoDB operations, SENS SMS delivery stats, and Telegram notifications, demonstrating <1% error rate and no customer-impacting incidents over the 7-day period; artifacts stored in `docs/validation/story-5.7/monitoring-log.md` and summarized in `VALIDATION.md` (`docs/epics/epic-5-deployment.md:207-235`, `docs/VALIDATION.md:1`).
2. Any anomaly triggers documented triage using runbook workflows, with root-cause notes, mitigation steps, and resolution time all within the <35 minute SLA; outcomes appended to the monitoring log (`docs/epics/epic-5-deployment.md:314-336`, `docs/ops/runbook.md:154-360`).
3. Performance metrics confirm Lambda duration stays <4 minutes (p95), DynamoDB exhibits zero throttles, and SENS/Telegram throughput meets NFRs; evidence includes CloudWatch metric exports for Day 0, Day 3, and Day 7 checkpoints (`docs/epics/epic-5-deployment.md:207-235`, `docs/epics/epic-5-deployment.md:297-322`).

**Integration Requirements**
4. CloudWatch dashboard screenshots, alarm histories, and Logs Insights query results are captured at least three times during the monitoring window and stored in `docs/validation/story-5.7/`, demonstrating healthy states and providing proof of observability coverage (`docs/epics/epic-5-deployment.md:297-322`, `docs/ops/cloudwatch-queries.md:1-120`).
5. Telegram (and Slack, if enabled) alerting channels receive at least one real or simulated notification for cutover start, success, and escalation drills, with message IDs or transcripts referenced in the evidence pack (`docs/epics/epic-5-deployment.md:321-349`, `docs/ops/runbook.md:360-404`).
6. Rollback rehearsal disables the EventBridge rule and redeploys the previous container image (or validates the procedure via tabletop) with start/end timestamps proving total execution within 35 minutes; transcripts saved to `docs/validation/story-5.7/rollback-drill.txt` (`docs/epics/epic-5-deployment.md:286-336`, `docs/stories/5.1.deploy-to-ecr.md:144-189`).

**Quality Requirements**
7. `VALIDATION.md` gains a `## Validation Evidence: Story 5.7 - Post-Cutover Monitoring` section summarizing metrics, incidents, approvals, and providing links to raw artifacts (`docs/epics/epic-5-deployment.md:231-235`, `docs/VALIDATION.md:1`).
8. Epic risk log and Go/No-Go Decision Point #3 are updated with either “No new risks” confirmation or documented mitigations, and the final go/no-go outcome recorded for closure (`docs/epics/epic-5-deployment.md:201-390`).
9. Runbook maintenance and migration completion steps (archiving legacy artifacts, updating operational procedures, training notes) are completed and referenced for Epic 6 hand-off (`docs/epics/epic-5-deployment.md:231-235`, `docs/ops/runbook.md:360-404`).

---

## Tasks / Subtasks

- [ ] Task 1: Establish monitoring cadence (AC1, AC3)
  - [ ] Create `docs/validation/story-5.7/monitoring-log.md` with daily checklist template covering metrics, incidents, and approvals (`docs/epics/epic-5-deployment.md:207-235`).
  - [ ] Schedule dashboard export times (Day 0, Day 3, Day 7) and configure alarm history retention for evidence capture (`docs/epics/epic-5-deployment.md:297-322`, `docs/ops/runbook.md:5-210`).

- [ ] Task 2: Operate daily monitoring runbooks (AC1, AC2, AC4)
  - [ ] Perform daily health checks using CloudWatch dashboards, Logs Insights queries, and SENS/Telegram delivery reports; append findings to the monitoring log (`docs/ops/runbook.md:1-210`, `docs/ops/cloudwatch-queries.md:1-200`).
  - [ ] Document any anomalies with timestamps, impact assessment, mitigation actions, and resolution outcomes, ensuring SLA compliance (`docs/epics/epic-5-deployment.md:314-336`).

- [ ] Task 3: Validate alerting and escalation flows (AC2, AC5, AC6)
  - [ ] Trigger or simulate Telegram/Slack notifications for cutover success and escalation drills; archive message IDs/screenshots in `docs/validation/story-5.7/notifications.md` (`docs/epics/epic-5-deployment.md:321-349`).
  - [ ] Conduct rollback drill (live or tabletop), recording start/end timestamps, commands executed, and participants in `docs/validation/story-5.7/rollback-drill.txt` (`docs/epics/epic-5-deployment.md:286-336`).

- [ ] Task 4: Package evidence and update documentation (AC3, AC4, AC7, AC8)
  - [ ] Export CloudWatch dashboards, alarm histories, and Logs Insights query outputs to `docs/validation/story-5.7/` with annotated context (`docs/epics/epic-5-deployment.md:297-322`, `docs/VALIDATION.md:1`).
  - [ ] Update `VALIDATION.md` and `docs/epics/epic-5-deployment.md` risk/go-no-go sections with daily summaries, approvals, and mitigation notes (`docs/epics/epic-5-deployment.md:201-390`).

- [ ] Task 5: Close migration and hand-off (AC8, AC9)
  - [ ] Archive legacy deployment artifacts, update `docs/ops/runbook.md` maintenance section, and log lessons learned for Epic 6 onboarding (`docs/epics/epic-5-deployment.md:231-235`, `docs/ops/runbook.md:360-404`).
  - [ ] Prepare final status communication summarizing monitoring results, stability metrics, and remaining follow-ups for stakeholders (`docs/epics/epic-5-deployment.md:352-390`).

---

## Dev Notes

- Utilize the runbook’s daily/weekly checklists to drive the monitoring cadence; document any deviations to keep audit coverage intact (`docs/ops/runbook.md:154-360`).
- For metric exports, prefer AWS CLI commands (e.g., `aws cloudwatch get-metric-data`) or dashboard PNG downloads and ensure filenames capture the timestamp (e.g., `dashboard-day3-<timestamp>.png`) (`docs/epics/epic-5-deployment.md:297-322`).
- Retain rollback command transcripts (`aws events disable-rule`, Docker image rollback) so operators can replicate actions quickly if triggers fire during the monitoring window (`docs/epics/epic-5-deployment.md:286-336`, `docs/stories/5.6.perform-production-cutover.md:137-173`).
- Continue collecting evidence in `docs/validation/story-5.7/` to avoid scrambling at the end of the watch period; each artifact should include a short context note linked back to acceptance criteria (`docs/VALIDATION.md:1`).
- Coordinate with Epic 6 leads to hand off monitoring insights, highlighting any residual risks or operational tweaks required after the stabilization window (`docs/epics/epic-5-deployment.md:352-390`).

### Testing

- Run daily CloudWatch Logs Insights queries for error rates, throttles, and SMS delivery mismatches to validate observability health (`docs/ops/cloudwatch-queries.md:1-200`).
- Use AWS CLI or dashboard exports to verify Lambda duration p95 <4 minutes and error rate <1% at each checkpoint (`docs/epics/epic-5-deployment.md:207-235`, `docs/epics/epic-5-deployment.md:297-322`).
- Simulate alarm transitions (if none occur naturally) using `aws cloudwatch set-alarm-state` to prove alert routing and on-call acknowledgement flows function correctly (`docs/epics/epic-5-deployment.md:321-349`).
- Execute rollback drill or tabletop exercise, capturing start/end timestamps and validating all commands/scripts perform as documented (`docs/epics/epic-5-deployment.md:286-336`).
- Verify evidence completeness by cross-checking `docs/validation/story-5.7/` contents against acceptance criteria before final sign-off (`docs/VALIDATION.md:1`).

---

## Open Questions

1. Should the 7-day stabilization window extend if minor (non-customer-facing) alarms trigger but are resolved within SLA, or can we document and proceed to closure? (`docs/epics/epic-5-deployment.md:352-390`)
2. Do stakeholders require additional communication channels (e.g., email summaries) beyond Telegram/Slack for daily monitoring updates? (`docs/ops/runbook.md:360-404`)
3. Is there a need to retain comparison-mode telemetry during the stabilization window for ad-hoc parity checks, or can those resources be decommissioned immediately post-cutover? (`docs/epics/epic-5-deployment.md:207-235`)

---

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-10-22 | 0.1 | Initial draft aligned to Epic 5 post-cutover monitoring requirements | Bob (Scrum Master) |

---

## Dev Agent Record

### Agent Model Used

- Pending assignment.

### Debug Log References

- Pending implementation.

### Completion Notes List

- Pending implementation.

### File List

- Pending implementation.

---

## QA Results

- Pending QA review.

